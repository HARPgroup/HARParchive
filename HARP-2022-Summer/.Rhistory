par(mfrow=c(1,2))
boxplot(Monthly_pre_mean, ylab = 'Monthly magnitude (cfs)', ylim = c(0,4000), main = 'Monthly mean pre-dam')
boxplot(Monthly_post_mean, ylab = 'Monthly magnitude (cfs)', ylim = c(0,4000), main = 'Monthly mean post-dam')
library(dataRetrieval)
library(zoo)
library(IHA)
library(dplyr)
library(lubridate)
library(ggplot2)
siteNo <- '11465200'
startDate_pre <- '1970-01-01'
endDate_pre <- '1980-12-31'
startDate_post <- '1985-01-01'
endDate_post <- '1995-12-31'
pCode <- '00060' #code for streamflow
sCode <- '00003' #average daily data
DRflow_pre <-readNWISdv(siteNo, pCode, startDate_pre, endDate_pre)
DRflow_post <-readNWISdv(siteNo, pCode, startDate_post, endDate_post)
head(DRflow_pre)
colnames(DRflow_pre) <- c('Agency', 'Site', 'Date', 'Flow', 'Code')
colnames(DRflow_post) <- c('Agency', 'Site', 'Date', 'Flow', 'Code')
par(mfrow=c(1,2)) #creates 2 windows side-by-side for the plots to be shown
plot(DRflow_pre$Date, DRflow_pre$Flow, type = 'l', col = 'red', ylim = c(0,20000))
plot(DRflow_post$Date, DRflow_post$Flow, type = 'l', col = 'blue', ylim = c(0,20000))
par(mfrow=c(1,2)) #creates 2 windows side-by-side for the plots to be shown
plot(DRflow_pre$Date, DRflow_pre$Flow, type = 'l', col = 'red', ylim = c(0,20000))
plot(DRflow_post$Date, DRflow_post$Flow, type = 'l', col = 'blue', ylim = c(0,20000))
plot(DRflow_pre$Date, DRflow_pre$Flow, type = 'l', col = 'red', ylim = c(0,20000))
par(mfrow=c(1,2)) #creates 2 windows side-by-side for the plots to be shown
plot(DRflow_pre$Date, DRflow_pre$Flow, type = 'l', col = 'red', ylim = c(0,20000))
plot(DRflow_post$Date, DRflow_post$Flow, type = 'l', col = 'blue', ylim = c(0,20000))
DRflow_post <-readNWISdv(siteNo, pCode, startDate_post, endDate_post)
par(mfrow=c(1,2)) #creates 2 windows side-by-side for the plots to be shown
plot(DRflow_pre$Date, DRflow_pre$Flow, type = 'l', col = 'red', ylim = c(0,20000))
plot(DRflow_post$Date, DRflow_post$Flow, type = 'l', col = 'blue', ylim = c(0,20000))
colnames(DRflow_post) <- c('Agency', 'Site', 'Date', 'Flow', 'Code')
par(mfrow=c(1,2)) #creates 2 windows side-by-side for the plots to be shown
plot(DRflow_pre$Date, DRflow_pre$Flow, type = 'l', col = 'red', ylim = c(0,20000))
plot(DRflow_post$Date, DRflow_post$Flow, type = 'l', col = 'blue', ylim = c(0,20000))
DRpre_z <- zoo(DRflow_pre$Flow, order.by=DRflow_pre$Date)
DRpost_z <- zoo(DRflow_post$Flow, order.by=DRflow_post$Date)
Monthly_pre_mean <- as.data.frame(group1(DRpre_z, year = 'calendar', FUN = mean))
Monthly_post_mean <- as.data.frame(group1(DRpost_z, year = 'calendar', FUN = mean))
Monthly_pre_med <- as.data.frame(group1(DRpre_z, year = 'calendar', FUN = median))
Monthly_post_med <- as.data.frame(group1(DRpost_z, year = 'calendar', FUN = median))
head(Monthly_pre_mean) #previewing one of the resulting tables for monthly magnitude
par(mfrow=c(1,2))
boxplot(Monthly_pre_mean, ylab = 'Monthly magnitude (cfs)', ylim = c(0,4000), main = 'Monthly mean pre-dam')
boxplot(Monthly_post_mean, ylab = 'Monthly magnitude (cfs)', ylim = c(0,4000), main = 'Monthly mean post-dam')
par(mfrow=c(1,2))
plot(Monthly_pre_mean$September, xlab = 'Year', ylab = 'Monthly magnitude (cfs)', ylim = c(1000,40000), main = 'Sept mean flows pre-dam', type = 'l', col = 'red')
plot(Monthly_post_mean$September, xlab = 'Year', ylab = 'Monthly magnitude (cfs)', ylim = c(1000,40000), main = 'Sept mean flows post-dam', type = 'l', col = 'blue')
par(mfrow=c(1,2))
plot(Monthly_pre_mean$September, xlab = 'Year', ylab = 'Monthly magnitude (cfs)', ylim = c(0,5000), main = 'Sept mean flows pre-dam', type = 'l', col = 'red')
plot(Monthly_post_mean$September, xlab = 'Year', ylab = 'Monthly magnitude (cfs)', ylim = c(0,5000), main = 'Sept mean flows post-dam', type = 'l', col = 'blue')
View(Monthly_pre_mean)
par(mfrow=c(1,2))
plot(Monthly_pre_mean$September, xlab = 'Year', ylab = 'Monthly magnitude (cfs)', ylim = c(0,500), main = 'Sept mean flows pre-dam', type = 'l', col = 'red')
plot(Monthly_post_mean$September, xlab = 'Year', ylab = 'Monthly magnitude (cfs)', ylim = c(0,500), main = 'Sept mean flows post-dam', type = 'l', col = 'blue')
par(mfrow=c(1,2))
plot(Monthly_pre_mean$September, xlab = 'Year', ylab = 'Monthly magnitude (cfs)', ylim = c(0,200), main = 'Sept mean flows pre-dam', type = 'l', col = 'red')
plot(Monthly_post_mean$September, xlab = 'Year', ylab = 'Monthly magnitude (cfs)', ylim = c(0,200), main = 'Sept mean flows post-dam', type = 'l', col = 'blue')
par(mfrow=c(1,2))
boxplot(Monthly_pre_mean, ylab = 'Monthly magnitude (cfs)', ylim = c(0,4000), main = 'Monthly mean pre-dam')
boxplot(Monthly_post_mean, ylab = 'Monthly magnitude (cfs)', ylim = c(0,4000), main = 'Monthly mean post-dam')
par(mfrow=c(1,2))
plot(Monthly_pre_mean$January, xlab = 'Year', ylab = 'Monthly magnitude (cfs)', ylim = c(0,200), main = 'Sept mean flows pre-dam', type = 'l', col = 'red')
plot(Monthly_post_mean$January, xlab = 'Year', ylab = 'Monthly magnitude (cfs)', ylim = c(0,200), main = 'Sept mean flows post-dam', type = 'l', col = 'blue')
par(mfrow=c(1,2))
plot(Monthly_pre_mean$January, xlab = 'Year', ylab = 'Monthly magnitude (cfs)', ylim = c(0,1000), main = 'Sept mean flows pre-dam', type = 'l', col = 'red')
plot(Monthly_post_mean$January, xlab = 'Year', ylab = 'Monthly magnitude (cfs)', ylim = c(0,1000), main = 'Sept mean flows post-dam', type = 'l', col = 'blue')
par(mfrow=c(1,2))
plot(Monthly_pre_mean$January, xlab = 'Year', ylab = 'Monthly magnitude (cfs)', ylim = c(0,10000), main = 'Sept mean flows pre-dam', type = 'l', col = 'red')
plot(Monthly_post_mean$January, xlab = 'Year', ylab = 'Monthly magnitude (cfs)', ylim = c(0,10000), main = 'Sept mean flows post-dam', type = 'l', col = 'blue')
gnitude (mean) for January before and after dam construction
par(mfrow=c(1,2))
plot(Monthly_pre_mean$January, xlab = 'Year', ylab = 'Monthly magnitude (cfs)', ylim = c(0,5000), main = 'Sept mean flows pre-dam', type = 'l', col = 'red')
plot(Monthly_post_mean$January, xlab = 'Year', ylab = 'Monthly magnitude (cfs)', ylim = c(0,5000), main = 'Sept mean flows post-dam', type = 'l', col = 'blue')
library(sf)
install.packages("forecast",
repos = c("http://rstudio.org/_packages",
"http://cran.rstudio.com"))
install.packages("sf",
repos = c("http://rstudio.org/_packages",
"http://cran.rstudio.com"))
library(sf)
library(dplyr)
library(sf)
knitr::opts_chunk$set(echo = TRUE)
library(data.table)
library(zoo)
library(IHA)
library(PearsonDS)
library(ggplot2)
library(dplyr)
library(lubridate)
agwo <- fread("HARP/forA51800_pwater.csv")
knitr::opts_chunk$set(echo = TRUE)
library(data.table)
library(zoo)
library(IHA)
library(PearsonDS)
library(ggplot2)
library(dplyr)
library(lubridate)
library(readr)
agwo <- fread("HARP/forA51800_pwater.csv")
agwo <- read_csv("~/HARP/forA51800_pwater.csv")
agwo$date <- as.Date(agwo$index, format = "%m/%d/%y")
agwo$week <- week(agwo$date)
agwo$month <- month(agwo$date)
pwater$year <- year(agwo$date)
agwo <- read_csv("~/HARP/forA51800_pwater.csv")
agwo$date <- as.Date(agwo$index, format = "%m/%d/%y")
agwo$week <- week(agwo$date)
agwo$month <- month(agwo$date)
agwo$year <- year(agwo$date)
dailyAGWO <- aggregate(agwo$AGWO, by = list(agwo$date), FUN = "sum")
colnames(dailyAGWO) <- c("date", "AGWO") # Changing column names
weeklyAGWO <- aggregate(agwo$AGWO, by = list(agwo$week, agwo$year), FUN = "sum")
monthlyAGWO <- aggregate(agwo$AGWO, by = list(agwo$month, agwo$year), FUN = "sum")
colnames(weeklyAGWO) <- c("week", "yr", "AGWO")
colnames(monthlyAGWO) <- c("month", "yr", "AGWO")
plot(dailyAGWO$date, dailyAGWO$AGWO, type ='l', ylab = 'Active Groundwater Outflow (in/day)', xlab = NA, col = 'blue')
title(main = 'AGWO (in/day)')
plot(dailyAGWO$date, dailyAGWO$AGWO, type ='l', ylab = 'AGWO (in)', xlab = NA, col = 'blue')
title(main = 'Daily Active Groundwater Outflow')
# Plotting monthly average
plot(monthlyAGWO$AGWO, type ='l', ylab = 'AGWO (in)', xaxt = 'n', xlab = NA, col = 'blue')
axis(1, at = seq(6,438,12), labels = years)
# Plotting monthly average
plot(monthlyAGWO$AGWO, type ='l', ylab = 'AGWO (in)', xaxt = 'n', xlab = NA, col = 'blue')
#axis(1, at = seq(6,438,12), labels = years)
title(main = 'Monthly Active Groundwater Outflow')
# Plotting monthly average
plot(monthlyAGWO$AGWO, type ='l', ylab = 'AGWO (in)', xaxt = 'n', xlab = NA, col = 'blue')
axis(1, at = seq(6,438,12), labels = years)
# Plotting monthly average
plot(monthlyAGWO$AGWO, type ='l', ylab = 'AGWO (in)', xaxt = 'n', xlab = NA, col = 'blue')
axis(1, at = seq(1,1909,53), labels = years)
# Plotting monthly average
plot(monthlyAGWO$date, monthlyAGWO$AGWO, type ='l', ylab = 'AGWO (in)', xaxt = 'n', xlab = NA, col = 'blue')
plot(dailyAGWO$date, dailyAGWO$AGWO, type ='l', ylab = 'AGWO (in)', xlab = 'year', col = 'blue')
title(main = 'Daily Active Groundwater Outflow')
library("devtools")
#library("lfstat")
library("hydrotools")
library(devtools)
#library("lfstat")
library("hydrotools")
rlang
rlang?
library("rlang")
library("devtools")
#install.packages("lfstat")
#install.packages("https://cran.r-project.org/src/contrib/Archive/lfstat/lfstat_0.9.4.tar.gz", repos=NULL, type="source")
install.packages("rlang")
install.packages("rlang")
library("rlang")
library("devtools")
#install.packages("lfstat")
#install.packages("https://cran.r-project.org/src/contrib/Archive/lfstat/lfstat_0.9.4.tar.gz", repos=NULL, type="source")
install.packages("rlang")
install.packages("rlang")
install.packages("rlang")
install.packages("rlang")
library("rlang")
library("devtools")
#library("lfstat")
library("hydrotools")
install.packages("usethis")
install.packages("usethis")
library("usethis")
library("rlang")
library("devtools")
#library("lfstat")
library("hydrotools")
install.packages("hydrotools")
#library("lfstat")
library("hydrotools")
library("hydroTSM")
library("zoo")
library("hydroTSM")
#library("lfstat")
library("hydrotools")
library(hydroTools)
basepath='/var/www/R';
source("/var/www/R/config.R")
remotes::install_gitlab("r-pkgs/hydroTools")
detach("package:hydroTools", unload = TRUE)
remotes::install_gitlab("r-pkgs/hydroTools")
#library("lfstat")
library("hydrotools") #CAN'T GET THIS TO WORK
install_github("HARPGRoup/hydro-tools", force = TRUE)
install.packages("hydrotools")
#library("lfstat")
library("hydrotools") #CAN'T GET THIS TO WORK
install.packages("R6")
install.packages("R6")
library("R6")
#library("lfstat")
library("hydrotools") #CAN'T GET THIS TO WORK
source("/var/www/R/config.R")
basepath='/var/www/R';
source("/var/www/R/config.R")
library("R6")
library("usethis")
library("rlang")
library("devtools")
#library("lfstat")
library("hydrotools") #CAN'T GET THIS TO WORK
library("hydroTSM")
library("zoo")
library("RCurl")
basepath='/var/www/R';
basepath='/var/www/R'
source("/var/www/R/config.R")
# Set up our data source
ds <- RomDataSource$new(site, rest_uname = rest_uname)
library("R6")
library("usethis")
library("rlang")
library("devtools")
#library("lfstat")
library("hydrotools") #CAN'T GET THIS TO WORK
library("hydroTSM")
library("zoo")
library("RCurl")
basepath='/var/www/R'
source("/var/www/R/config.R")
source = ("/var/www/R/config.R")
# Set up our data source
ds <- RomDataSource$new(site, rest_uname = rest_uname)
ds$get_token(rest_pw)
# token <- rest_token(site, token, rest_uname, rest_pw)
# options(timeout=1200) # set timeout to twice default level to avoid abort due to high traffic
# Shared config
library(pander);
library(httr);
library(hydroTSM);
library(sqldf);
# paths and libs
source(paste(basepath,'config.local.private',sep='/'));
# paths and libs
source = (paste(basepath,'config.local.private',sep='/'));
source = (paste(hydro_tools,"VAHydro-2.0/rest_functions.R", sep = "/"));
source = (paste(hydro_tools,"VAHydro-1.0/fn_vahydro-1.0.R", sep = "/"));
source = (paste(hydro_tools,"LowFlow/fn_iha.R", sep = "/"));
source = (paste(basepath,"auth.private", sep = "/"));#load rest username and password, contained in auth.private file
omsite = "http://deq1.bse.vt.edu:81"
site = "http://deq1.bse.vt.edu:81/d.dh"
json_obj_url <- paste(site, "node/62", sep ="/")
# Set up our data source
ds <- RomDataSource$new(site, rest_uname = rest_uname)
ds$get_token(rest_pw)
source("/var/www/R/config.R")
source?
?
stop
source("/var/www/R/config.R")
basepath='/var/www/R';
source("/var/www/R/config.R")
source"/var/www/R/config.R"
source(/var/www/R/config.R)
source('/var/www/R/config.R')
source("/var/www/R/config.R")
source("/var/www/R/config.R")
# Set up our data source
ds <- RomDataSource$new(site, rest_uname = rest_uname)
ds$get_token(rest_pw)
# TBD: get inputs from the command line
#  For now we just load some samples
lseg_name="A51800"
lseg_ftype="cbp532_landseg"
landseg <- RomFeature$new(
ds,
list(
hydrocode=lseg_name,
ftype=lseg_ftype,
bundle='landunit'
),
TRUE
)
model <- RomProperty$new(
ds,
list(
varkey="om_model_element",
propname=landseg$name,
featureid=landseg$hydroid,
entity_type="dh_feature",
propcode="cbp-5.3.2"
),
TRUE
)
model$save(TRUE)
library("lubridate")
model <- RomProperty$new(
ds,
list(
varkey="om_model_element",
propname=landseg$name,
featureid=landseg$hydroid,
entity_type="dh_feature",
propcode="cbp-5.3.2"
),
TRUE
)
model$save(TRUE)
lu <- RomProperty$new(
ds,
list(
varkey="om_hspf_landuse",
propname="for",
featureid=model$pid,
entity_type="dh_properties",
propcode="for"
),
TRUE
)
lu$save(TRUE)
#
ts <- RomTS$new(
ds,
list(
varkey="om_scenario",
featureid=model$pid,
entity_type="dh_properties",
tscode="p532sova_2021"
),
TRUE
)
ts$tstime = as.integer(as.POSIXct("2022/07/07 12:00:00", origin="1970-01-01"))
ts$save(TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(data.table)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(data.table)
library(zoo)
library(IHA)
library(PearsonDS)
library(ggplot2)
library(dplyr)
library(lubridate)
library(readr)
pwater <- read_csv("forA51800_pwater.csv")
pwater$date <- as.Date(pwater$index, format = "%m/%d/%y")
pwater$week <- week(pwater$date)
pwater$month <- month(pwater$date)
pwater$year <- year(pwater$date)
View(monthlyAGWO)
install.packages(TTR)
library(TTR)
monthly_AGWS <- SMA(pwater$AGWS, n = 30)
# Plotting monthly average
years <- seq(1984,2020,1)
plot(monthlyAGWS$AGWS, type ='l', ylab = 'Active Groundwater Storage (in)', xaxt = 'n', xlab = NA, col = 'blue')
dailyAGWS <- aggregate(pwater$AGWS, by = list(pwater$date), FUN = "mean")
colnames(dailyAGWS) <- c("date", "AGWS") # Changing column names
monthlyAGWS <- aggregate(pwater$AGWS, by = list(pwater$month, pwater$year), FUN = "mean")
colnames(monthlyAGWS) <- c("month", "yr", "AGWS")
# Plotting monthly average
years <- seq(1984,2020,1)
plot(monthlyAGWS$AGWS, type ='l', ylab = 'Active Groundwater Storage (in)', xaxt = 'n', xlab = NA, col = 'blue')
axis(1, at = seq(6,438,12), labels = years)
title(main = 'AGWS (monthly average)')
