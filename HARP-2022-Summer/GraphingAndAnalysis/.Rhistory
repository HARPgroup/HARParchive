colnames(monthlyAGWS) <- c("month","year", "AGWS")
View(monthlyAGWS)
ggplot(data=dailyAGWS, aes(x=year, y=AGWS)) + geom_boxplot(aes(group=cut(year, "5 year")))
View(dailyAGWS)
dailyAGWS$year <- year(dailyAGWS$date)
AGWS_interval <- filter(dailyAGWS, year==1:6|year==7:12|year==13:18|year==19:24|year==25:30
|year==31:36)
AGWS_int_ave <- aggregate(AGWS_interval$AGWS, by = list(AGWS_interval$year), FUN = "mean")
View(AGWS_interval)
View(dailyAGWS)
AGWS_interval <- filter(dailyAGWS$year, year==1:6|year==7:12|year==13:18|year==19:24|year==25:30
|year==31:36)
AGWS_interval <- filter(dailyAGWS, year==1:6|year==7:12|year==13:18|year==19:24|year==25:30
|year==31:36)
yearlyAGWS <- aggregate(pwater$AGWS, by = list(pwater$year), FUN = "mean")
colnames(yearlyAGWS) <- c("year", "AGWS")
View(yearlyAGWS)
AGWS_interval <- filter(yearlyAGWS, year==1:6|year==7:12|year==13:18|year==19:24|year==25:30
|year==31:36)
setwd("/Users/VT_SA/Documents/HARP")
pwater <- read_csv("forA51800_pwater.csv")
pwater$date <- as.Date(pwater$index, format = "%m/%d/%y")
pwater$week <- week(pwater$date)
pwater$month <- month(pwater$date)
pwater$year <- year(pwater$date)
yearlyAGWS <- aggregate(pwater$AGWS, by = list(pwater$year), FUN = "mean")
colnames(yearlyAGWS) <- c("year", "AGWS")
View(yearlyAGWS)
View(yearlyAGWS)
agws_decomp <- decompose(AGWS_ts, type = "additive") #here we note the type of data set we are working with
# the functions below require data that is created with ts()
AGWS_ts <- ts(monthlyAGWS$AGWS, start = c(1984,1), end = c(2020,12), frequency = 12)
dailyAGWS <- aggregate(pwater$AGWS, by = list(pwater$date), FUN = "mean")
colnames(dailyAGWS) <- c("date", "AGWS")
monthlyAGWS <- aggregate(pwater$AGWS, by = list(pwater$month, pwater$year), FUN = "mean")
colnames(monthlyAGWS) <- c("month","year", "AGWS")
yearlyAGWS <- aggregate(pwater$AGWS, by = list(pwater$year), FUN = "mean")
colnames(yearlyAGWS) <- c("year", "AGWS")
# the functions below require data that is created with ts()
AGWS_ts <- ts(monthlyAGWS$AGWS, start = c(1984,1), end = c(2020,12), frequency = 12)
# frequency = 12 (monthly); = 4 (quarterly); = 1 (annual)
agws_decomp <- decompose(AGWS_ts, type = "additive") #here we note the type of data set we are working with
plot(agws_decomp)
decomp_df <- data.frame(agws_decomp$figure)
colnames(decomp_df) <- c('Seasonality')
rownames(decomp_df) <- c('Jan','Feb','Mar','Apr','May','June','July','Aug','Sep','Oct','Nov','Dec')
decomp_df
plot(agws_decomp$figure, type = 'l', ylab = 'AGWS Fitted Trend (in)', xaxt = 'n', xlab = NA, col = 'blue')
axis(1, at = seq(1,12,1), labels = c('Jan','Feb','Mar','Apr','May','June','July','Aug','Sep','Oct','Nov','Dec'))
title(main = 'Active Groundwater Storage Fitted Trend (1984-2020)')
agws_holt_winters <- HoltWinters(AGWS_ts, gamma = FALSE, seasonal = "additive") #gamma set as false since we aren't dealing with additive data
plot(agws_holt_winters, col = 'blue')
agws_ab <- data.frame(agws_holt_winters$alpha, agws_holt_winters$beta)
colnames(agws_ab) <- c('Alpha','Beta')
rownames(agws_ab) <- c('AGWS')
agws_ab
# Extracting the trend -column from the fitted values:
agws_fitted <- data.frame(agws_holt_winters$fitted)
plot(agws_fitted$trend, type = 'l', ylab = 'AGWS Fitted Trend', xaxt = 'n', xlab = NA, col = 'blue')
years <- seq(1984,2020,1)
axis(1, at = seq(6,444,12), labels = years)
title(main = 'Active Groundwater Storage Fitted Trend')
agws_decomp <- decompose(AGWS_ts, type = "multiplicative") #here we note the type of data set we are working with
plot(agws_decomp)
decomp_df <- data.frame(agws_decomp$figure)
colnames(decomp_df) <- c('Seasonality')
rownames(decomp_df) <- c('Jan','Feb','Mar','Apr','May','June','July','Aug','Sep','Oct','Nov','Dec')
decomp_df
plot(agws_decomp$figure, type = 'l', ylab = 'AGWS Fitted Trend (in)', xaxt = 'n', xlab = NA, col = 'blue')
axis(1, at = seq(1,12,1), labels = c('Jan','Feb','Mar','Apr','May','June','July','Aug','Sep','Oct','Nov','Dec'))
title(main = 'Active Groundwater Storage Fitted Trend (1984-2020)')
acf(decomp_df$random, lag.max=20, na.action = na.omit)
acf(agws_decomp$random, lag.max=20, na.action = na.omit)
acf(agws_decomp$random, lag.max=20, na.action = na.omit)
#acf(agws_decomp$random, lag.max=20, na.action = na.omit)
ssacf<- function(agws_decomp) sum(acf(agws_decomp, na.action = na.omit)$acf^2)
compare_ssacf<-function(add,mult) ifelse(ssacf(add)< ssacf(mult), "Additive", "Multiplicative")
sample_ts[,.(ts_type = compare_ssacf(residual_a, residual_m ))]
#acf(agws_decomp$random, lag.max=20, na.action = na.omit)
ssacf<- function(agws_decomp) sum(acf(agws_decomp, na.action = na.omit)$acf^2)
compare_ssacf<-function(add,mult) ifelse(ssacf(add)< ssacf(mult), "Additive", "Multiplicative")
AGWS_ts[,.(ts_type = compare_ssacf(residual_a, residual_m ))]
#acf(agws_decomp$random, lag.max=20, na.action = na.omit)
ssacf<- function(agws_decomp) sum(acf(agws_decomp, na.action = na.omit)$acf^2)
compare_ssacf<-function(add,mult) ifelse(ssacf(add)< ssacf(mult), "Additive", "Multiplicative")
AGWS_ts[,(ts_type = compare_ssacf(residual_a, residual_m ))]
#acf(agws_decomp$random, lag.max=20, na.action = na.omit)
ssacf<- function(agws_decomp) sum(acf(agws_decomp, na.action = na.omit)$acf^2)
compare_ssacf<-function(add,mult) ifelse(ssacf(add)< ssacf(mult), "Additive", "Multiplicative")
AGWS_ts[,(ts_type = compare_ssacf('residual_a', 'residual_m' ))]
#acf(agws_decomp$random, lag.max=20, na.action = na.omit)
ssacf<- function(agws_decomp) sum(acf(agws_decomp$random, na.action = na.omit)$acf^2)
compare_ssacf<-function(add,mult) ifelse(ssacf(add)< ssacf(mult), "Additive", "Multiplicative")
AGWS_ts[,(ts_type = compare_ssacf('residual_a', 'residual_m' ))]
Box.test(agws_decomp$random, lag=20, type="Ljung-Box")
plot.ts(agws_decomp$random)
agws_decompM <- decompose(AGWS_ts, type = "multiplicative") #here we note the type of data set we are working with
plot(agws_decompM)
decomp_dfM <- data.frame(agws_decompM$figure)
colnames(decomp_dfM) <- c('Seasonality')
rownames(decomp_dfM) <- c('Jan','Feb','Mar','Apr','May','June','July','Aug','Sep','Oct','Nov','Dec')
decomp_dfM
plot(agws_decompM$figure, type = 'l', ylab = 'AGWS Fitted Trend (in)', xaxt = 'n', xlab = NA, col = 'blue')
axis(1, at = seq(1,12,1), labels = c('Jan','Feb','Mar','Apr','May','June','July','Aug','Sep','Oct','Nov','Dec'))
title(main = 'Active Groundwater Storage Fitted Trend (1984-2020)')
agws_decompA <- decompose(AGWS_ts, type = "additive") #here we note the type of data set we are working with
plot(agws_decompA)
decomp_dfA <- data.frame(agws_decompA$figure)
colnames(decomp_dfA) <- c('Seasonality')
rownames(decomp_dfA) <- c('Jan','Feb','Mar','Apr','May','June','July','Aug','Sep','Oct','Nov','Dec')
decomp_dfA
plot(agws_decompA$figure, type = 'l', ylab = 'AGWS Fitted Trend (in)', xaxt = 'n', xlab = NA, col = 'blue')
axis(1, at = seq(1,12,1), labels = c('Jan','Feb','Mar','Apr','May','June','July','Aug','Sep','Oct','Nov','Dec'))
title(main = 'Active Groundwater Storage Fitted Trend (1984-2020)')
acfM <- acf(agws_decompM$random, lag.max=20, na.action = na.omit)
ljung_boxM <- Box.test(agws_decompM$random, lag=20, type="Ljung-Box")
plot.ts(agws_decompM$random)
acfA <- acf(agws_decompA$random, lag.max=20, na.action = na.omit)
ljung_boxA <- Box.test(agws_decompA$random, lag=20, type="Ljung-Box")
plot.ts(agws_decompA$random)
#ssacf<- function(agws_decomp) sum(acf(agws_decomp, na.action = na.omit)$acf^2)
#compare_ssacf<-function(add,mult) ifelse(ssacf(add)< ssacf(mult), "Additive", "Multiplicative")
#AGWS_ts[,(ts_type = compare_ssacf('residual_a', 'residual_m' ))]
df_AM_comp <- data.frame(acfM, acfA, ljung_boxM, ljung_boxA)
acfM <- acf(agws_decompM$random, lag.max=20, na.action = na.omit)
acfM <- acf(agws_decompM$random, lag.max=20, na.action = na.omit)
df_AM_comp <- data.frame(ljung_boxM, ljung_boxA)
ljung_boxM <- Box.test(agws_decompM$random, lag=20, type="Ljung-Box")
ljung_boxM <- Box.test(agws_decompM$random, lag=20, type="Ljung-Box")
ljung_boxA
ljung_boxM
ssacf<- function(agws_decomp) sum(acf(agws_decomp, na.action = na.omit)$acf^2)
ssacf
compare_ssacf<-function(add,mult) ifelse(ssacf(add)< ssacf(mult), "Additive", "Multiplicative")
compare_ssacf()
compare_ssacf
AGWS_ts[,(ts_type = compare_ssacf('residual_a', 'residual_m' ))]
AGWS_ts[,.(ts_type = compare_ssacf('residual_a', 'residual_m' ))]
AGWS_ts[,.('multiplicative' = compare_ssacf('residual_a', 'residual_m' ))]
AGWS_ts[,('multiplicative' = compare_ssacf('residual_a', 'residual_m' ))]
ssacf<- function(agws_decomp) sum(acf(agws_decomp, na.action = na.omit)$acf^2)
compare_ssacf<-function(add,mult) ifelse(ssacf(add)< ssacf(mult), "Additive", "Multiplicative")
AGWS_ts[,(multiplicative = compare_ssacf('residual_a', 'residual_m' ))]
ssacf<- function(x) sum(acf(x, na.action = na.omit)$acf^2)
compare_ssacf<-function(add,mult) ifelse(ssacf(add)< ssacf(mult), "Additive", "Multiplicative")
AGWS_ts[,(multiplicative = compare_ssacf('residual_a', 'residual_m' ))]
ssacf<- function(x) sum(acf(agws_decompM$random, na.action = na.omit)$acf^2)
compare_ssacf<-function(add,mult) ifelse(ssacf(add)< ssacf(mult), "Additive", "Multiplicative")
AGWS_ts[,(multiplicative = compare_ssacf('residual_a', 'residual_m' ))]
ssacf<- function(x) sum(acf(agws_decompM$random, na.action = na.omit)$acf^2)
compare_ssacf<-function(add,mult) ifelse(ssacf(add)< ssacf(mult), "Additive", "Multiplicative")
AGWS_ts[,.(multiplicative = compare_ssacf('residual_a', 'residual_m' ))]
ssacf<- function(x) sum(acf(agws_decompM$random, na.action = na.omit)$acf^2)
compare_ssacf<-function(add,mult) ifelse(ssacf(add)< ssacf(mult), "Additive", "Multiplicative")
AGWS_ts[,.,(multiplicative = compare_ssacf('residual_a', 'residual_m' ))]
ssacf<- function(x) sum(acf(agws_decompM$random, na.action = na.omit)$acf^2)
compare_ssacf<-function(add,mult) ifelse(ssacf(add)< ssacf(mult), "Additive", "Multiplicative")
AGWS_ts[,'.'(multiplicative = compare_ssacf('residual_a', 'residual_m' ))]
ssacf<- function(x) sum(acf(x, na.action = na.omit)$acf^2)
compare_ssacf<-function(add,mult) ifelse(ssacf(add)< ssacf(mult), "Additive", "Multiplicative")
AGWS_ts[,(multiplicative = compare_ssacf('residual_a', 'residual_m' ))]
ac_holtfA <- acf(agws_holt_winters$residuals, lag.max=20, na.action = na.omit)
agws_holt_winters <- HoltWinters(AGWS_ts, gamma = FALSE, seasonal = "additive") #gamma set as false since we aren't dealing with additive data
plot(agws_holt_winters, col = 'blue')
agws_ab <- data.frame(agws_holt_winters$alpha, agws_holt_winters$beta)
colnames(agws_ab) <- c('Alpha','Beta')
rownames(agws_ab) <- c('AGWS')
agws_ab
# Extracting the trend -column from the fitted values:
agws_fitted <- data.frame(agws_holt_winters$fitted)
plot(agws_fitted$trend, type = 'l', ylab = 'AGWS Fitted Trend', xaxt = 'n', xlab = NA, col = 'blue')
years <- seq(1984,2020,1)
axis(1, at = seq(6,444,12), labels = years)
title(main = 'Active Groundwater Storage Fitted Trend')
acf_holtA <- acf(agws_holt_winters$residuals, lag.max=20, na.action = na.omit)
View(ljung_boxA)
View(agws_holt_winters)
agws_holt_winters <- HoltWinters(AGWS_ts, seasonal = "additive") #gamma set as false since we aren't dealing with additive data
plot(agws_holt_winters, col = 'blue')
agws_ab <- data.frame(agws_holt_winters$alpha, agws_holt_winters$beta)
colnames(agws_ab) <- c('Alpha','Beta')
rownames(agws_ab) <- c('AGWS')
agws_ab
# Extracting the trend -column from the fitted values:
agws_fitted <- data.frame(agws_holt_winters$fitted)
plot(agws_fitted$trend, type = 'l', ylab = 'AGWS Fitted Trend', xaxt = 'n', xlab = NA, col = 'blue')
years <- seq(1984,2020,1)
axis(1, at = seq(6,444,12), labels = years)
title(main = 'Active Groundwater Storage Fitted Trend')
acf_holtA <- acf(agws_holt_winters$coefficients, lag.max=20, na.action = na.omit)
ljung_boxM <- Box.test(agws_decompM$random, lag=20, type="Ljung-Box")
plot.ts(agws_decompM$random)
View(agws_holt_winters)
acf_holtA <- acf(agws_holt_winters$coefficients, lag.max=20, na.action = na.omit)
ljung_boxM <- Box.test(agws_holt_winters$coefficients, lag=20, type="Ljung-Box")
plot.ts(agws_holt_winters$coefficients)
acf_holtA <- acf(agws_holt_winters$coefficients, lag.max=20, na.action = na.omit)
ljung_boxM <- Box.test(agws_holt_winters$coefficients, lag=20, type="Ljung-Box")
plot.ts(agws_holt_winters$coefficients)
agws_holt_winters <- HoltWinters(AGWS_ts, seasonal = "multiplicative") #gamma set as false since we aren't dealing with additive data
plot(agws_holt_winters, col = 'blue')
agws_ab <- data.frame(agws_holt_winters$alpha, agws_holt_winters$beta)
colnames(agws_ab) <- c('Alpha','Beta')
rownames(agws_ab) <- c('AGWS')
agws_ab
# Extracting the trend -column from the fitted values:
agws_fitted <- data.frame(agws_holt_winters$fitted)
plot(agws_fitted$trend, type = 'l', ylab = 'AGWS Fitted Trend', xaxt = 'n', xlab = NA, col = 'blue')
years <- seq(1984,2020,1)
axis(1, at = seq(6,444,12), labels = years)
title(main = 'Active Groundwater Storage Fitted Trend')
acf_holtA <- acf(agws_holt_winters$coefficients, lag.max=20, na.action = na.omit)
ljung_boxM <- Box.test(agws_holt_winters$coefficients, lag=20, type="Ljung-Box")
plot.ts(agws_holt_winters$coefficients)
acf_holtA <- acf(agws_holt_winters$coefficients, lag.max=20, na.action = na.omit)
ljung_boxM <- Box.test(agws_holt_winters$coefficients, lag=20, type="Ljung-Box")
ljung_boxM
plot.ts(agws_holt_winters$coefficients)
agws_holt_winters <- HoltWinters(AGWS_ts, gamma = FALSE, seasonal = "multiplicative") #gamma set as false since we aren't dealing with additive data
plot(agws_holt_winters, col = 'blue')
agws_ab <- data.frame(agws_holt_winters$alpha, agws_holt_winters$beta)
colnames(agws_ab) <- c('Alpha','Beta')
rownames(agws_ab) <- c('AGWS')
agws_ab
# Extracting the trend -column from the fitted values:
agws_fitted <- data.frame(agws_holt_winters$fitted)
plot(agws_fitted$trend, type = 'l', ylab = 'AGWS Fitted Trend', xaxt = 'n', xlab = NA, col = 'blue')
years <- seq(1984,2020,1)
axis(1, at = seq(6,444,12), labels = years)
title(main = 'Active Groundwater Storage Fitted Trend')
acf_holtA <- acf(agws_holt_winters$coefficients, lag.max=20, na.action = na.omit)
ljung_boxM <- Box.test(agws_holt_winters$coefficients, lag=20, type="Ljung-Box")
ljung_boxM
plot.ts(agws_holt_winters$coefficients)
acf_holtA <- acf(agws_holt_winters$coefficients, na.action = na.omit)
ljung_boxM <- Box.test(agws_holt_winters$coefficients, lag=20, type="Ljung-Box")
ljung_boxM
plot.ts(agws_holt_winters$coefficients)
agws_holt_winters <- HoltWinters(AGWS_ts, gamma = TRUE, seasonal = "additive") #gamma set as false since we aren't dealing with additive data
plot(agws_holt_winters, col = 'blue')
agws_ab <- data.frame(agws_holt_winters$alpha, agws_holt_winters$beta)
colnames(agws_ab) <- c('Alpha','Beta')
rownames(agws_ab) <- c('AGWS')
agws_ab
# Extracting the trend -column from the fitted values:
agws_fitted <- data.frame(agws_holt_winters$fitted)
plot(agws_fitted$trend, type = 'l', ylab = 'AGWS Fitted Trend', xaxt = 'n', xlab = NA, col = 'blue')
years <- seq(1984,2020,1)
axis(1, at = seq(6,444,12), labels = years)
title(main = 'Active Groundwater Storage Fitted Trend')
acf_holtA <- acf(agws_holt_winters$coefficients, na.action = na.omit)
ljung_boxM <- Box.test(agws_holt_winters$coefficients, lag=20, type="Ljung-Box")
ljung_boxM
plot.ts(agws_holt_winters$coefficients)
agws_holt_winters <- HoltWinters(AGWS_ts, gamma = FALSE, seasonal = "additive") #gamma set as false since we aren't dealing with additive data
plot(agws_holt_winters, col = 'blue')
agws_ab <- data.frame(agws_holt_winters$alpha, agws_holt_winters$beta)
colnames(agws_ab) <- c('Alpha','Beta')
rownames(agws_ab) <- c('AGWS')
agws_ab
# Extracting the trend -column from the fitted values:
agws_fitted <- data.frame(agws_holt_winters$fitted)
plot(agws_fitted$trend, type = 'l', ylab = 'AGWS Fitted Trend', xaxt = 'n', xlab = NA, col = 'blue')
years <- seq(1984,2020,1)
axis(1, at = seq(6,444,12), labels = years)
title(main = 'Active Groundwater Storage Fitted Trend')
acf_holtA <- acf(agws_holt_winters$coefficients, na.action = na.omit)
ljung_boxM <- Box.test(agws_holt_winters$coefficients, lag=20, type="Ljung-Box")
ljung_boxM
plot.ts(agws_holt_winters$coefficients)
agws_holt_winters <- HoltWinters(AGWS_ts, gamma = FALSE, seasonal = "multiplicative") #gamma set as false since we aren't dealing with additive data
plot(agws_holt_winters, col = 'blue')
agws_ab <- data.frame(agws_holt_winters$alpha, agws_holt_winters$beta)
colnames(agws_ab) <- c('Alpha','Beta')
rownames(agws_ab) <- c('AGWS')
agws_ab
# Extracting the trend -column from the fitted values:
agws_fitted <- data.frame(agws_holt_winters$fitted)
plot(agws_fitted$trend, type = 'l', ylab = 'AGWS Fitted Trend', xaxt = 'n', xlab = NA, col = 'blue')
years <- seq(1984,2020,1)
axis(1, at = seq(6,444,12), labels = years)
title(main = 'Active Groundwater Storage Fitted Trend')
acf_holtA <- acf(agws_holt_winters$coefficients, na.action = na.omit)
ljung_boxM <- Box.test(agws_holt_winters$coefficients, lag=20, type="Ljung-Box")
ljung_boxM
plot.ts(agws_holt_winters$coefficients)
knitr::opts_chunk$set(echo = TRUE)
library(data.table)
library(zoo)
library(IHA)
library(PearsonDS)
library(ggplot2)
library(dplyr)
library(lubridate)
library(readr)
setwd("/Users/VT_SA/Documents/HARP")
pwater <- read_csv("forA51800_pwater.csv")
pwater$date <- as.Date(pwater$index, format = "%m/%d/%y")
pwater$week <- week(pwater$date)
pwater$month <- month(pwater$date)
pwater$year <- year(pwater$date)
dailyAGWS <- aggregate(pwater$AGWS, by = list(pwater$date), FUN = "mean")
colnames(dailyAGWS) <- c("date", "AGWS")
monthlyAGWS <- aggregate(pwater$AGWS, by = list(pwater$month, pwater$year), FUN = "mean")
colnames(monthlyAGWS) <- c("month","year", "AGWS")
yearlyAGWS <- aggregate(pwater$AGWS, by = list(pwater$year), FUN = "mean")
colnames(yearlyAGWS) <- c("year", "AGWS")
agws_decompM <- decompose(AGWS_ts, type = "multiplicative") #here we note the type of data set we are working with
# the functions below require data that is created with ts()
AGWS_ts <- ts(monthlyAGWS$AGWS, start = c(1984,1), end = c(2020,12), frequency = 12)
# frequency = 12 (monthly); = 4 (quarterly); = 1 (annual)
agws_decompM <- decompose(AGWS_ts, type = "multiplicative") #here we note the type of data set we are working with
plot(agws_decompM)
decomp_dfM <- data.frame(agws_decompM$figure)
colnames(decomp_dfM) <- c('Seasonality')
rownames(decomp_dfM) <- c('Jan','Feb','Mar','Apr','May','June','July','Aug','Sep','Oct','Nov','Dec')
decomp_dfM
plot(agws_decompM$figure, type = 'l', ylab = 'AGWS Fitted Trend (in)', xaxt = 'n', xlab = NA, col = 'blue')
axis(1, at = seq(1,12,1), labels = c('Jan','Feb','Mar','Apr','May','June','July','Aug','Sep','Oct','Nov','Dec'))
title(main = 'Active Groundwater Storage Fitted Trend (1984-2020)')
agws_decompM <- decompose(AGWS_ts, type = "multiplicative") #here we note the type of data set we are working with
plot(agws_decompM)
decomp_dfM <- data.frame(agws_decompM$figure)
colnames(decomp_dfM) <- c('Seasonality')
rownames(decomp_dfM) <- c('Jan','Feb','Mar','Apr','May','June','July','Aug','Sep','Oct','Nov','Dec')
decomp_dfM
plot(agws_decompM$seasonal, type = 'l', ylab = 'AGWS Fitted Trend (in)', xaxt = 'n', xlab = NA, col = 'blue')
axis(1, at = seq(1,12,1), labels = c('Jan','Feb','Mar','Apr','May','June','July','Aug','Sep','Oct','Nov','Dec'))
title(main = 'Active Groundwater Storage Fitted Trend (1984-2020)')
plot(agws_decompM$figure, type = 'l', ylab = 'AGWS Fitted Trend (in)', xaxt = 'n', xlab = NA, col = 'blue')
axis(1, at = seq(1,12,1), labels = c('Jan','Feb','Mar','Apr','May','June','July','Aug','Sep','Oct','Nov','Dec'))
title(main = 'Active Groundwater Storage Fitted Trend (1984-2020)')
agws_holt_winters <- HoltWinters(AGWS_ts, gamma = FALSE, seasonal = "multiplicative") #gamma set as false since we aren't dealing with additive data
plot(agws_holt_winters, col = 'blue')
agws_ab <- data.frame(agws_holt_winters$alpha, agws_holt_winters$beta)
colnames(agws_ab) <- c('Alpha','Beta')
rownames(agws_ab) <- c('AGWS')
agws_ab
# Extracting the trend -column from the fitted values:
agws_fitted <- data.frame(agws_holt_winters$fitted)
plot(agws_fitted$trend, type = 'l', ylab = 'AGWS Fitted Trend', xaxt = 'n', xlab = NA, col = 'blue')
years <- seq(1984,2020,1)
axis(1, at = seq(6,444,12), labels = years)
title(main = 'Active Groundwater Storage Fitted Trend')
agws_holt_winters <- HoltWinters(AGWS_ts, gamma = TRUE, seasonal = "additive") #gamma set as false since we aren't dealing with additive data
plot(agws_holt_winters, col = 'blue')
agws_ab <- data.frame(agws_holt_winters$alpha, agws_holt_winters$beta)
colnames(agws_ab) <- c('Alpha','Beta')
rownames(agws_ab) <- c('AGWS')
agws_ab
# Extracting the trend -column from the fitted values:
agws_fitted <- data.frame(agws_holt_winters$fitted)
plot(agws_fitted$trend, type = 'l', ylab = 'AGWS Fitted Trend', xaxt = 'n', xlab = NA, col = 'blue')
years <- seq(1984,2020,1)
axis(1, at = seq(6,444,12), labels = years)
title(main = 'Active Groundwater Storage Fitted Trend')
agws_holt_winters <- HoltWinters(AGWS_ts, gamma = FALSE, seasonal = "multiplicative") #gamma set as false since we aren't dealing with additive data
plot(agws_holt_winters, col = 'blue')
agws_ab <- data.frame(agws_holt_winters$alpha, agws_holt_winters$beta)
colnames(agws_ab) <- c('Alpha','Beta')
rownames(agws_ab) <- c('AGWS')
agws_ab
# Extracting the trend -column from the fitted values:
agws_fitted <- data.frame(agws_holt_winters$fitted)
plot(agws_fitted$trend, type = 'l', ylab = 'AGWS Fitted Trend', xaxt = 'n', xlab = NA, col = 'blue')
years <- seq(1984,2020,1)
axis(1, at = seq(6,444,12), labels = years)
title(main = 'Active Groundwater Storage Fitted Trend')
agws_holt_winters <- HoltWinters(AGWS_ts, gamma = TRUE, seasonal = "multiplicative") #gamma set as false since we aren't dealing with additive data
plot(agws_holt_winters, col = 'blue')
agws_ab <- data.frame(agws_holt_winters$alpha, agws_holt_winters$beta)
colnames(agws_ab) <- c('Alpha','Beta')
rownames(agws_ab) <- c('AGWS')
agws_ab
# Extracting the trend -column from the fitted values:
agws_fitted <- data.frame(agws_holt_winters$fitted)
plot(agws_fitted$trend, type = 'l', ylab = 'AGWS Fitted Trend', xaxt = 'n', xlab = NA, col = 'blue')
years <- seq(1984,2020,1)
axis(1, at = seq(6,444,12), labels = years)
title(main = 'Active Groundwater Storage Fitted Trend')
agws_holt_winters <- HoltWinters(AGWS_ts, gamma = FALSE, seasonal = "multiplicative") #gamma set as false since we aren't dealing with additive data
plot(agws_holt_winters, col = 'blue')
agws_ab <- data.frame(agws_holt_winters$alpha, agws_holt_winters$beta)
colnames(agws_ab) <- c('Alpha','Beta')
rownames(agws_ab) <- c('AGWS')
agws_ab
# Extracting the trend -column from the fitted values:
agws_fitted <- data.frame(agws_holt_winters$fitted)
plot(agws_fitted$trend, type = 'l', ylab = 'AGWS Fitted Trend', xaxt = 'n', xlab = NA, col = 'blue')
years <- seq(1984,2020,1)
axis(1, at = seq(6,444,12), labels = years)
title(main = 'Active Groundwater Storage Fitted Trend')
#par(mfrow=c(1,2))
dailyAGWS$month <- month(dailyAGWS$date)
dailyAGWS$year <- year(dailyAGWS$date)
dailySummer <- filter(dailyAGWS, month==7|month==8|month==9|month==10)
monthlySummer <- aggregate(dailySummer$AGWS, by = list(dailySummer$month, dailySummer$year), FUN = "mean")
colnames(monthlySummer) <- c('Month', 'Year', 'AGWS')
monthlySummer$date <-  as.Date(paste(monthlySummer$Month, monthlySummer$Year, '15'), '%m %Y %d')
dailyWinter <- filter(dailyAGWS, month==1 | month==2 | month==3 | month==12)
monthlyWinter <- aggregate(dailyWinter$AGWS, by = list(dailyWinter$month, dailyWinter$year), FUN = "mean")
colnames(monthlyWinter) <- c('Month', 'Year', 'AGWS')
monthlyWinter$date <-  as.Date(paste(monthlyWinter$Month, monthlyWinter$Year, '15'), '%m %Y %d')
boxplot(dailySummer$AGWS, dailyWinter$AGWS, ylab = 'Daily AGWS (in)', xaxt = 'n', xlab = NA,
main = 'Active Groundwater Storage in 1984-2020', col = c("pink", "lightblue"))
axis(1, at = 1:2, labels = c('Summer (July - Oct)', 'Winter (Dec - March)'))
knitr::opts_chunk$set(echo = TRUE)
library(data.table)
library(zoo)
library(IHA)
library(PearsonDS)
library(ggplot2)
library(dplyr)
library(lubridate)
library(readr)
setwd("/Users/VT_SA/Documents/HARP")
pwater <- read_csv("forA51800_pwater.csv")
pwater$date <- as.Date(pwater$index, format = "%m/%d/%y")
pwater$week <- week(pwater$date)
pwater$month <- month(pwater$date)
pwater$year <- year(pwater$date)
dailyAGWS <- aggregate(pwater$AGWS, by = list(pwater$date), FUN = "mean")
colnames(dailyAGWS) <- c("date", "AGWS")
monthlyAGWS <- aggregate(pwater$AGWS, by = list(pwater$month, pwater$year), FUN = "mean")
colnames(monthlyAGWS) <- c("month","year", "AGWS")
yearlyAGWS <- aggregate(pwater$AGWS, by = list(pwater$year), FUN = "mean")
colnames(yearlyAGWS) <- c("year", "AGWS")
# the functions below require data that is created with ts()
AGWS_ts <- ts(monthlyAGWS$AGWS, start = c(1984,1), end = c(2020,12), frequency = 12)
# frequency = 12 (monthly); = 4 (quarterly); = 1 (annual)
agws_decompM <- decompose(AGWS_ts, type = "multiplicative") #here we note the type of data set we are working with
plot(agws_decompM)
decomp_dfM <- data.frame(agws_decompM$figure)
colnames(decomp_dfM) <- c('Seasonality')
rownames(decomp_dfM) <- c('Jan','Feb','Mar','Apr','May','June','July','Aug','Sep','Oct','Nov','Dec')
decomp_dfM
plot(agws_decompM$figure, type = 'l', ylab = 'AGWS Fitted Trend (in)', xaxt = 'n', xlab = NA, col = 'blue')
axis(1, at = seq(1,12,1), labels = c('Jan','Feb','Mar','Apr','May','June','July','Aug','Sep','Oct','Nov','Dec'))
title(main = 'Active Groundwater Storage Fitted Trend (1984-2020)')
agws_decompA <- decompose(AGWS_ts, type = "additive") #here we note the type of data set we are working with
plot(agws_decompA)
decomp_dfA <- data.frame(agws_decompA$figure)
colnames(decomp_dfA) <- c('Seasonality')
rownames(decomp_dfA) <- c('Jan','Feb','Mar','Apr','May','June','July','Aug','Sep','Oct','Nov','Dec')
decomp_dfA
plot(agws_decompA$figure, type = 'l', ylab = 'AGWS Fitted Trend (in)', xaxt = 'n', xlab = NA, col = 'blue')
axis(1, at = seq(1,12,1), labels = c('Jan','Feb','Mar','Apr','May','June','July','Aug','Sep','Oct','Nov','Dec'))
title(main = 'Active Groundwater Storage Fitted Trend (1984-2020)')
acfM <- acf(agws_decompM$random, lag.max=20, na.action = na.omit)
ljung_boxM <- Box.test(agws_decompM$random, lag=20, type="Ljung-Box")
plotM <- plot.ts(agws_decompM$random)
acfA <- acf(agws_decompA$random, lag.max=20, na.action = na.omit)
ljung_boxA <- Box.test(agws_decompA$random, lag=20, type="Ljung-Box")
plotA <- plot.ts(agws_decompA$random)
acfM
plotM_acf <- plot.ts(acfM)
plotM_acf <- plot(acfM)
plotM <- plot.ts(agws_decompM$random)
ljung_boxM <- Box.test(agws_decompM$random, lag=20, type="Ljung-Box")
ljung_boxM
ljung_boxA
plotA <- plot(acfA)
ljung_boxA$p.value
ljung_boxA$parameter
ljung_boxM <- Box.test(agws_decompM$random, lag=1, type="Ljung-Box")
ljung_boxM
ljung_boxA <- Box.test(agws_decompA$random, lag=1, type="Ljung-Box")
ljung_boxA
print(ljung_boxM)
print(ljung_boxA)
acfM <- acf(agws_decompM$random, lag.max=20, na.action = na.omit)
plotM_acf <- plot(acfM)
ljung_boxM <- Box.test(agws_decompM$random, lag=1, type="Ljung-Box")
print(ljung_boxM)
acfA <- acf(agws_decompA$random, lag.max=20, na.action = na.omit)
plotA <- plot(acfA)
ljung_boxA <- Box.test(agws_decompA$random, lag=1, type="Ljung-Box")
print(ljung_boxA)
#multiplicative
acfM <- acf(agws_decompM$random, lag.max=20, na.action = na.omit)
plotM_acf <- plot(acfM)
ljung_boxM <- Box.test(agws_decompM$random, lag=1, type="Ljung-Box")
print(ljung_boxM)
#additive
acfA <- acf(agws_decompA$random, lag.max=20, na.action = na.omit)
plotA_acf <- plot(acfA)
ljung_boxA <- Box.test(agws_decompA$random, lag=1, type="Ljung-Box")
print(ljung_boxA)
acfM <- acf(agws_decompM$random, na.action = na.omit)
plotM_acf <- plot(acfM)
#multiplicative
acfM <- acf(agws_decompM$random, na.action = na.omit)
plotM_acf <- plot(acfM)
ljung_boxM <- Box.test(agws_decompM$random, lag=1, type="Ljung-Box")
print(ljung_boxM)
#additive
acfA <- acf(agws_decompA$random, na.action = na.omit)
plotA_acf <- plot(acfA)
ljung_boxA <- Box.test(agws_decompA$random, lag=1, type="Ljung-Box")
print(ljung_boxA)
print(ljung_boxM, ljung_boxA)
print(ljung_boxM && ljung_boxA)
#multiplicative
acfM <- acf(agws_decompM$random, na.action = na.omit)
plotM_acf <- plot(acfM)
ljung_boxM <- Box.test(agws_decompM$random, lag=1, type="Ljung-Box")
print(ljung_boxM)
#additive
acfA <- acf(agws_decompA$random, na.action = na.omit)
plotA_acf <- plot(acfA)
ljung_boxA <- Box.test(agws_decompA$random, lag=1, type="Ljung-Box")
print(ljung_boxA)
