---
title: "facilities_REST_test"
author: "Analysts"
date: "`r Sys.Date()`"
output: html_document
params:
  # county or region codes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(hydrotools)
basepath='/var/www/R'
source('/var/www/R/config.R')
ds <- RomDataSource$new("http://deq1.bse.vt.edu/d.dh", rest_uname)
ds$get_token(rest_pw)
```

```{r Pulling all Regions/Counties}
all_counties <- RomFeature$new(ds,list(bundle='usafips'),TRUE)
counties.df <- cbind(all_counties[["name"]], all_counties[["hydrocode"]])
  colnames(counties.df) <- c("County", "hydrocode_fips")

all_regions <- RomFeature$new(ds,list(ftype= 'wsp_plan_region'),TRUE)
regions.df <- cbind(all_regions[["name"]], all_regions[["hydrocode"]])
  colnames(regions.df) <- c("Region", "hydrocode")
```

```{r, TESTING}
#pick Amelia county codes
county_name <- counties.df[88,1]
county_hydrocode <- counties.df[88,2]
county_hydroid <- all_counties[["hydroid"]][88]

region_name <- regions.df[19,1]
region_hydrocode <- regions.df[19,2]
region_hydroid <- all_regions[["hydroid"]][19]
```

```{r Specific County/Region}
#pull specific region feature----
region <- RomFeature$new(ds, list(
      ftype= 'wsp_plan_region',
      hydrocode= region_hydrocode,
      bundle= 'landunit'), 
  TRUE)

#pull specific county feature----
county <- RomFeature$new(ds, list(
  ftype= 'county',
  hydrocode= county_hydrocode,
  bundle= 'usafips'), 
  TRUE)
```

```{r Ella Testing}
token <- rest_token(base_url = site,rest_pw = rest_pw)

#Pulls all localities, can specify one with adminid in list
locality.ds <- getAdminregFeature(inputs = list(
  bundle = 'registration',
  ftype = 'wsp_plan_locality'), base_url = site)

#pull specific values
locality_name <- locality.ds[1,5]
locality_adminID <- locality.ds[1,1]

#Pulls all facilities, can specify one with adminid in list
facility.ds <- getAdminregFeature(inputs = list(
  bundle = 'registration',
  ftype = 'vdeq_vwuds'), base_url = site)

#pull specific values
facility_name <- facility.ds[1,5]
facility_adminID <- facility.ds[1,1]

#we want to be able to pull data from these localities and facilities

```